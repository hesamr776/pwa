(self.webpackChunknakhlex=self.webpackChunknakhlex||[]).push([[6323],{76323:function(e,t,r){var u=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=u(r(87757)),a=u(r(319)),n=u(r(63038)),i=u(r(67154)),s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var u={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var n=l?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(u,a,n):u[a]=e[a]}return u.default=e,r&&r.set(e,u),u}(r(67294)),o=u(r(13330)),m=u(r(56706)),c=r(59693),f=r(39698),d=r(34787),_=r(46823),b=r(40930),N=r(4070),p=r(51222),g=r(50599),v=this,E="/Users/phinix/Workspace/BitBayt/src/features/P2P/screens/Dispute.tsx";function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}var I=(0,_.createSchema)({reason:(0,_.requiredStringSchema)((0,f.$t)("disputeReason")),subReason:(0,_.requiredStringSchema)((0,f.$t)("specificIssue")),proofText:(0,_.requiredStringSchema)((0,f.$t)("proofText")),proofImage:(0,_.requiredMixSchema)((0,f.$t)("proofImage")),otherReasons:(0,_.stringSchema)()});t.default=function(e){var t=e.route,r=e.navigation,u=t.params,a=u.orderId,n=u.side,i=(0,p.useP2PDisputeStatusApi)(a),f=i.data,d=i.isFetching,_=i.isLoading,b=s.default.useCallback((function(){return l.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.default.awrap(N.queryClient.invalidateQueries("Dispute"));case 2:case"end":return e.stop()}}),null,null,null,Promise)}),[]);return s.default.createElement(c.Screen,{__self:v,__source:{fileName:E,lineNumber:65,columnNumber:5}},_?s.default.createElement(c.Loading,{__self:v,__source:{fileName:E,lineNumber:67,columnNumber:9}}):s.default.createElement(m.default,{refreshControl:s.default.createElement(o.default,{refreshing:d,onRefresh:b,__self:v,__source:{fileName:E,lineNumber:71,columnNumber:13}}),__self:v,__source:{fileName:E,lineNumber:69,columnNumber:9}},s.default.createElement(c.View,{justifyContent:"flex-start",flex:1,paddingTop:"m",__self:v,__source:{fileName:E,lineNumber:73,columnNumber:11}},(null==f?void 0:f.dealerDispute)&&s.default.createElement(D,{dealerDispute:f.dealerDispute,side:n,__self:v,__source:{fileName:E,lineNumber:75,columnNumber:15}}),(null==f?void 0:f.userDispute)&&s.default.createElement(y,{userDispute:f.userDispute,proof:f.userDisputeProof,navigation:r,__self:v,__source:{fileName:E,lineNumber:82,columnNumber:15}}),(!(null!=f&&f.userDispute)||"supportInvalid"===f.userDispute.status)&&s.default.createElement(x,{orderId:a,side:n,__self:v,__source:{fileName:E,lineNumber:91,columnNumber:15}}))))};var D=function(e){var t=e.dealerDispute,r=e.side;return s.default.createElement(s.default.Fragment,null,s.default.createElement(c.Text,(0,i.default)({variant:"text",color:"orange"},c.MediumFontProps,{__self:v,__source:{fileName:E,lineNumber:110,columnNumber:7}}),(0,f.$t)("inDispute")),s.default.createElement(c.View,{borderRadius:8,backgroundColor:"gray4",padding:"s",marginVertical:"m",__self:v,__source:{fileName:E,lineNumber:114,columnNumber:7}},s.default.createElement(c.Text,(0,i.default)({variant:"body"},c.MediumFontProps,{__self:v,__source:{fileName:E,lineNumber:119,columnNumber:9}}),"buy"===r?(0,f.$t)("sellerDisputed"):(0,f.$t)("buyerDisputed")),s.default.createElement(c.Text,(0,i.default)({variant:"body"},c.MediumFontProps,{__self:v,__source:{fileName:E,lineNumber:122,columnNumber:9}}),(0,f.$t)("weAreOnIt")),s.default.createElement(g.DetailItem,{item:"status",details:{status:(0,f.$t)(t.status)},__self:v,__source:{fileName:E,lineNumber:126,columnNumber:9}}),s.default.createElement(g.DetailItem,{item:"disputeReason",details:{disputeReason:t.reason},__self:v,__source:{fileName:E,lineNumber:130,columnNumber:9}}),s.default.createElement(g.DetailItem,{item:"specificIssue",details:{specificIssue:t.subReason},__self:v,__source:{fileName:E,lineNumber:134,columnNumber:9}})))},y=function(e){var t=e.userDispute,r=e.proof,u=e.navigation;return s.default.createElement(s.default.Fragment,null,s.default.createElement(g.DetailItem,{item:"status",details:{status:(0,f.$t)(t.status)},__self:v,__source:{fileName:E,lineNumber:154,columnNumber:7}}),s.default.createElement(g.DetailItem,{item:"disputeReason",details:{disputeReason:t.reason},__self:v,__source:{fileName:E,lineNumber:155,columnNumber:7}}),s.default.createElement(g.DetailItem,{item:"specificIssue",details:{specificIssue:t.subReason},__self:v,__source:{fileName:E,lineNumber:159,columnNumber:7}}),s.default.createElement(c.View,{flexDirection:"row",paddingVertical:"m",__self:v,__source:{fileName:E,lineNumber:164,columnNumber:7}},s.default.createElement(c.Pressable,{flex:1,paddingEnd:"s",justifyContent:"center",alignItems:"center",borderRadius:10,onPress:function(){u.navigate("ImageViewer",{uri:r.image})},__self:v,__source:{fileName:E,lineNumber:165,columnNumber:9}},s.default.createElement(c.Image,{source:{uri:r.image},width:(c.WIDTH-40)/4,borderRadius:8,height:Math.min(c.WIDTH/2,170),__self:v,__source:{fileName:E,lineNumber:174,columnNumber:11}})),s.default.createElement(c.View,{flex:3,paddingStart:"s",__self:v,__source:{fileName:E,lineNumber:182,columnNumber:9}},s.default.createElement(c.Text,{variant:"body",__self:v,__source:{fileName:E,lineNumber:183,columnNumber:11}},r.text))))},x=function(e){var t=e.orderId,r=e.side,u=(0,p.useDisputeP2POrderApi)(),l=u.mutate,a=u.isLoading,o=(0,d.useCustomForm)(I),m=o.control,_=o.setValue,g=o.handleSubmit,h=o.formState.isValid,D=(0,b.useController)({control:m,name:"reason"}).field.value,y=w(D,r),x=(0,n.default)(y,2),P=x[0],$=x[1];return s.default.createElement(c.View,{flex:1,justifyContent:"space-between",__self:v,__source:{fileName:E,lineNumber:225,columnNumber:5}},s.default.createElement(c.Text,{marginVertical:"m",color:"gray1",__self:v,__source:{fileName:E,lineNumber:226,columnNumber:7}},(0,f.$t)("disputeHint")),s.default.createElement(c.SelectB,{control:m,name:"reason",label:(0,f.$t)("disputeReason"),data:P,__self:v,__source:{fileName:E,lineNumber:230,columnNumber:7}}),s.default.createElement(c.SelectB,{control:m,disabled:!D,name:"subReason",label:(0,f.$t)("specificIssue"),data:$,__self:v,__source:{fileName:E,lineNumber:237,columnNumber:7}}),"other_reason"===D&&s.default.createElement(c.Input,{label:(0,f.$t)("disputeReason"),placeholder:(0,f.$t)("enterDisputeInformation"),control:m,name:"otherReasons",textarea:!0,__self:v,__source:{fileName:E,lineNumber:246,columnNumber:9}}),s.default.createElement(c.View,{flexDirection:"row",paddingVertical:"m",__self:v,__source:{fileName:E,lineNumber:255,columnNumber:7}},s.default.createElement(c.View,{flex:1,paddingEnd:"s",justifyContent:"center",alignItems:"center",__self:v,__source:{fileName:E,lineNumber:256,columnNumber:9}},s.default.createElement(c.Image,{name:"attachment",width:24,height:21.6,__self:v,__source:{fileName:E,lineNumber:261,columnNumber:11}}),s.default.createElement(c.ImagePicker,{name:"proofImage",setValue:_,position:"absolute",bottom:0,top:0,left:0,right:0,__self:v,__source:{fileName:E,lineNumber:262,columnNumber:11}})),s.default.createElement(c.View,{flex:3,paddingStart:"s",__self:v,__source:{fileName:E,lineNumber:273,columnNumber:9}},s.default.createElement(c.Text,{variant:"body",__self:v,__source:{fileName:E,lineNumber:274,columnNumber:11}},(0,f.$t)("disputeProofHint")))),s.default.createElement(c.Input,{textarea:!0,control:m,name:"proofText",label:(0,f.$t)("additionalInformation"),placeholder:(0,f.$t)("enterAdInformation"),__self:v,__source:{fileName:E,lineNumber:278,columnNumber:7}}),s.default.createElement(c.Button,{loading:a,disabled:!h,onPress:g((function(e){l((0,i.default)({},e,{orderId:t}),{onSuccess:function(e){e.ok?(N.queryClient.invalidateQueries("Dispute"),(0,c.showPopupMessage)((0,f.$t)("successful"),"success")):(0,c.extractFetchError)(e)}})})),label:(0,f.$t)("submit"),__self:v,__source:{fileName:E,lineNumber:286,columnNumber:7}}))},w=function(e,t){var r=(0,p.useP2PDisputeReasonsApi)().data,u=void 0===r?{buyer:{},seller:{}}:r,l=(0,s.useMemo)((function(){return{}}),[]);return[(0,s.useMemo)((function(){var e=u["buy"===t?"buyer":"seller"];return Object.keys(e).map((function(t){var r=e[t];return r.data&&(l[t]=Object.keys(r.data).map((function(e){return r.data&&e in r.data?{label:r.data[e].value,value:e}:{label:"subReason.value",value:e}}))),{label:r.value,value:t}}))}),[l,u,t]),(0,s.useMemo)((function(){var t=e&&l[e]?l[e]:[];return[].concat((0,a.default)(t),[{label:(0,f.$t)("noneOfTheAbove"),value:"other_reason"}])}),[l,e])]}}}]);